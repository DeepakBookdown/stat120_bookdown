<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 13 Class Activity 6 | Stat 120</title>
<meta name="author" content="Deepak Bastola">
<meta name="description" content="13.1 Your Turn 1  13.1.1 Beer Example A study of 16 Ohio State University students looked at the relationship between the number of beers a student consumes and their blood alcohol content (BAC)...">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="Chapter 13 Class Activity 6 | Stat 120">
<meta property="og:type" content="book">
<meta property="og:description" content="13.1 Your Turn 1  13.1.1 Beer Example A study of 16 Ohio State University students looked at the relationship between the number of beers a student consumes and their blood alcohol content (BAC)...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 13 Class Activity 6 | Stat 120">
<meta name="twitter:description" content="13.1 Your Turn 1  13.1.1 Beer Example A study of 16 Ohio State University students looked at the relationship between the number of beers a student consumes and their blood alcohol content (BAC)...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Stat 120</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction to Statistics</a></li>
<li class="book-part">Basics R</li>
<li><a class="" href="what-is-r.html"><span class="header-section-number">1</span> What is R?</a></li>
<li><a class="" href="r-markdown-basics.html"><span class="header-section-number">2</span> R Markdown Basics</a></li>
<li><a class="" href="helpful-r-codes.html"><span class="header-section-number">3</span> Helpful R codes</a></li>
<li><a class="" href="homework-guidelines.html"><span class="header-section-number">4</span> Homework Guidelines</a></li>
<li><a class="" href="graph-formatting.html"><span class="header-section-number">5</span> Graph Formatting</a></li>
<li><a class="" href="table-formatting.html"><span class="header-section-number">6</span> Table Formatting</a></li>
<li><a class="" href="report-guidelines.html"><span class="header-section-number">7</span> Report Guidelines</a></li>
<li class="book-part">Class Activity</li>
<li><a class="" href="class-activity-1.html"><span class="header-section-number">8</span> Class Activity 1</a></li>
<li><a class="" href="class-activity-2.html"><span class="header-section-number">9</span> Class Activity 2</a></li>
<li><a class="" href="class-activity-3.html"><span class="header-section-number">10</span> Class Activity 3</a></li>
<li><a class="" href="class-activity-4.html"><span class="header-section-number">11</span> Class Activity 4</a></li>
<li><a class="" href="class-activity-5.html"><span class="header-section-number">12</span> Class Activity 5</a></li>
<li><a class="active" href="class-activity-6.html"><span class="header-section-number">13</span> Class Activity 6</a></li>
<li><a class="" href="class-activity-7.html"><span class="header-section-number">14</span> Class Activity 7</a></li>
<li><a class="" href="class-activity-8.html"><span class="header-section-number">15</span> Class Activity 8</a></li>
<li><a class="" href="class-activity-9.html"><span class="header-section-number">16</span> Class Activity 9</a></li>
<li><a class="" href="class-activity-10.html"><span class="header-section-number">17</span> Class Activity 10</a></li>
<li><a class="" href="class-activity-11.html"><span class="header-section-number">18</span> Class Activity 11</a></li>
<li><a class="" href="class-activity-12.html"><span class="header-section-number">19</span> Class Activity 12</a></li>
<li><a class="" href="class-activity-13.html"><span class="header-section-number">20</span> Class Activity 13</a></li>
<li><a class="" href="class-activity-14.html"><span class="header-section-number">21</span> Class Activity 14</a></li>
<li><a class="" href="class-activity-15.html"><span class="header-section-number">22</span> Class Activity 15</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="class-activity-6" class="section level1" number="13">
<h1>
<span class="header-section-number">13</span> Class Activity 6<a class="anchor" aria-label="anchor" href="#class-activity-6"><i class="fas fa-link"></i></a>
</h1>
<div id="your-turn-1-3" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> Your Turn 1<a class="anchor" aria-label="anchor" href="#your-turn-1-3"><i class="fas fa-link"></i></a>
</h2>
<div id="beer-example" class="section level3" number="13.1.1">
<h3>
<span class="header-section-number">13.1.1</span> Beer Example<a class="anchor" aria-label="anchor" href="#beer-example"><i class="fas fa-link"></i></a>
</h3>
<p>A study of 16 Ohio State University students looked at the relationship between the number of beers a student consumes and their blood alcohol content (BAC) 30 minutes after their last beer. The regression information from R to predict BAC from number of beers consumed is given below.</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="va">bac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/deepbas/statdatasets/main/BAC.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="a-always-start-with-a-visual" class="section level3" number="13.1.2">
<h3>
<span class="header-section-number">13.1.2</span> (a) Always start with a visual!!!!<a class="anchor" aria-label="anchor" href="#a-always-start-with-a-visual"><i class="fas fa-link"></i></a>
</h3>
<p>Plot the response (BAC) on the y-axis and the explanatory (“predictor”) on the x-axis.</p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bac</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Beers</span>, y <span class="op">=</span> <span class="va">BAC</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-2-1.png" width="100%"></div>
<p>You can modify this basic graph by adding a title and axes labels.</p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bac</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Beers</span>, y <span class="op">=</span> <span class="va">BAC</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">19</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Beer and BAC"</span>,</span>
<span>          x <span class="op">=</span> <span class="st">"Number of beers drank"</span>,</span>
<span>          y <span class="op">=</span> <span class="st">"Blood Alcohol Content"</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-3-1.png" width="100%"></div>
<ul>
<li>Is there a relationship?
<ul>
<li>direction?</li>
<li>strength?</li>
<li>form?</li>
</ul>
</li>
</ul>
</div>
<div id="b-computing-correlation" class="section level3" number="13.1.3">
<h3>
<span class="header-section-number">13.1.3</span> (b) Computing correlation<a class="anchor" aria-label="anchor" href="#b-computing-correlation"><i class="fas fa-link"></i></a>
</h3>
<p>Since the <em>form</em> of the relationship is linear, we can use <strong>correlation</strong> to measure its strength:</p>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">bac</span><span class="op">$</span><span class="va">BAC</span>, <span class="va">bac</span><span class="op">$</span><span class="va">Beers</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.8943381</code></pre>
<p>If there are any missing values (<code>NA</code>’s) on either of the variables involved in the correlation calculation, use <code>use = "complete.obs"</code> as an extra argument to the <code>cor</code> function.</p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">bac</span><span class="op">$</span><span class="va">BAC</span>, <span class="va">bac</span><span class="op">$</span><span class="va">Beers</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.8943381</code></pre>
</div>
<div id="c-fitting-a-regression-line" class="section level3" number="13.1.4">
<h3>
<span class="header-section-number">13.1.4</span> (c) Fitting a regression line<a class="anchor" aria-label="anchor" href="#c-fitting-a-regression-line"><i class="fas fa-link"></i></a>
</h3>
<p>We use the <code>lm(y ~ x, data=mydata)</code> function to fit a <strong>l</strong>inear (regression) <strong>m</strong>odel for a response y given an explanatory variable x. This command creates a <strong>linear model object</strong> that needs to be assigned a name, here we call it <code>bac.lm</code>. You can get the slope and intercept by typing out the object name:</p>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bac.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data<span class="op">=</span><span class="va">bac</span><span class="op">)</span></span>
<span><span class="va">bac.lm</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac)

Coefficients:
(Intercept)        Beers  
   -0.01270      0.01796  </code></pre>
<ul>
<li>After running the <code>lm</code> command above in your R console, check the <strong>Environment</strong> tab to see that the object <code>bac.lm</code> is now one of the objects stored in R’s memory (for this session of Rstudio).</li>
<li>Write down the fitted regression equation to predict BAC from number of beers.</li>
</ul>
<details><summary><red>Click for answer</red></summary><p><em>Answer:</em> <span class="math inline">\(\hat{y} = \ldots\)</span></p>
<ul>
<li>You can add this regression line to your scatterplot from part (a) by creating the plot and using the <code>abline</code> command:</li>
</ul>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Customized scatter plot with regression line</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bac</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Beers</span>, y <span class="op">=</span> <span class="va">BAC</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">19</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Beer and BAC"</span>,</span>
<span>          x <span class="op">=</span> <span class="st">"Number of beers drank"</span>,</span>
<span>          y <span class="op">=</span> <span class="st">"Blood Alcohol Content"</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-7-1.png" width="100%"></div>
</details><p><br></p>
</div>
<div id="d-interpret-the-slope-in-context." class="section level3" number="13.1.5">
<h3>
<span class="header-section-number">13.1.5</span> (d) Interpret the slope in context.<a class="anchor" aria-label="anchor" href="#d-interpret-the-slope-in-context."><i class="fas fa-link"></i></a>
</h3>
<details><summary><red>Click for answer</red></summary><em>Answer:</em> Drinking one more beer is associated with a 0.0180 unit increase in predicted BAC.
</details><p><br></p>
</div>
<div id="e-interpret-the-intercept-in-context-if-it-makes-sense-to-do-so." class="section level3" number="13.1.6">
<h3>
<span class="header-section-number">13.1.6</span> (e) Interpret the intercept in context, if it makes sense to do so.<a class="anchor" aria-label="anchor" href="#e-interpret-the-intercept-in-context-if-it-makes-sense-to-do-so."><i class="fas fa-link"></i></a>
</h3>
<details><summary><red>Click for answer</red></summary><em>Answer:</em> The intercept is -0.0127. A student who drinks 0 beers would be predicted to have a negative blood alcohol content. This is not possible so the intercept does not make sense in this context, but the intercept is included in the model to get the best fit line for the data collected.
</details><p><br></p>
</div>
<div id="f-if-your-friend-at-ohio-state-drank-2-beers-what-would-you-predict-their-bac-to-be" class="section level3" number="13.1.7">
<h3>
<span class="header-section-number">13.1.7</span> (f) If your friend at Ohio State drank 2 beers, what would you predict their BAC to be?<a class="anchor" aria-label="anchor" href="#f-if-your-friend-at-ohio-state-drank-2-beers-what-would-you-predict-their-bac-to-be"><i class="fas fa-link"></i></a>
</h3>
<details><summary><red>Click for answer</red></summary><p><em>Answer:</em> The predicted BAC is</p>
<p><span class="math display">\[
\widehat{BAC} = -0.0127 + 0.0180(2) = 0.0233.
\]</span></p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y.hat</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.0127</span> <span class="op">+</span> <span class="fl">0.0180</span><span class="op">*</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> </span>
<span><span class="va">y.hat</span></span></code></pre></div>
<pre><code>[1] 0.0233</code></pre>
</details><p><br></p>
</div>
<div id="g-find-the-residual-for-the-student-in-the-dataset-who-drank-2-beers-and-had-a-bac-of-0.03." class="section level3" number="13.1.8">
<h3>
<span class="header-section-number">13.1.8</span> (g) Find the residual for the student in the dataset who drank 2 beers and had a BAC of 0.03.<a class="anchor" aria-label="anchor" href="#g-find-the-residual-for-the-student-in-the-dataset-who-drank-2-beers-and-had-a-bac-of-0.03."><i class="fas fa-link"></i></a>
</h3>
<details><summary><red>Click for answer</red></summary><p><em>Answer:</em> The residual is</p>
<p><span class="math display">\[
BAC - \widehat{BAC} = .03 - .0233=0.0067
\]</span></p>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0.03</span> <span class="op">-</span> <span class="op">(</span><span class="op">-</span><span class="fl">0.0127</span> <span class="op">+</span> <span class="fl">0.0180</span><span class="op">*</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<pre><code>[1] 0.0067</code></pre>
</details><p><br></p>
</div>
<div id="h-getting-residuals-in-r" class="section level3" number="13.1.9">
<h3>
<span class="header-section-number">13.1.9</span> (h) Getting residuals in R<a class="anchor" aria-label="anchor" href="#h-getting-residuals-in-r"><i class="fas fa-link"></i></a>
</h3>
<p>We can use the <code>resid</code> command to get the residuals for each case in the data set:</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Residuals </span></span>
<span><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Beers <span class="op">=</span> <span class="va">bac</span><span class="op">$</span><span class="va">Beers</span>, Residuals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">residuals</span></span></code></pre></div>
<pre><code>   Beers    Residuals
1      5  0.022881795
2      2  0.006773080
3      9  0.041026747
4      8 -0.011009491
5      3 -0.001190682
6      7 -0.018045729
7      3  0.028809318
8      5 -0.017118205
9      3 -0.021190682
10     5 -0.027118205
11     4  0.010845557
12     6  0.004918033
13     5  0.007881795
14     7 -0.023045729
15     1  0.004736842
16     4 -0.009154443</code></pre>
</div>
<div id="i-getting-r2-value" class="section level3" number="13.1.10">
<h3>
<span class="header-section-number">13.1.10</span> (i) Getting <span class="math inline">\(R^2\)</span> value<a class="anchor" aria-label="anchor" href="#i-getting-r2-value"><i class="fas fa-link"></i></a>
</h3>
<p>You can use the <code>summary</code> command on an <code>lm</code> object to get a more detailed print out of your linear model, along with the <span class="math inline">\(R^2\)</span> value for your model:</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.027118 -0.017350  0.001773  0.008623  0.041027 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.012701   0.012638  -1.005    0.332    
Beers        0.017964   0.002402   7.480 2.97e-06 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02044 on 14 degrees of freedom
Multiple R-squared:  0.7998,    Adjusted R-squared:  0.7855 
F-statistic: 55.94 on 1 and 14 DF,  p-value: 2.969e-06</code></pre>
</div>
<div id="j-making-a-residuals-plot" class="section level3" number="13.1.11">
<h3>
<span class="header-section-number">13.1.11</span> (j) Making a residuals plot<a class="anchor" aria-label="anchor" href="#j-making-a-residuals-plot"><i class="fas fa-link"></i></a>
</h3>
<p>The regression of <code>BAC</code> on <code>Beers</code> has a residuals plot that plots the model’s residuals on the y-axis and the explanatory (“predictor”) on the x-axis. We add a horizontal reference line (the detrended regression line) with the <code><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline()</a></code> command:</p>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># code for residual plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">residuals</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Beers</span>, y <span class="op">=</span> <span class="va">Residuals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">19</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Residuals Plot"</span>,</span>
<span>                x <span class="op">=</span> <span class="st">"Number of beers drank"</span>,</span>
<span>                y <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span> <span class="op">+</span></span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-12-1.png" width="100%"></div>
<p><strong>Interpret:</strong> There is one case of 9 beers with a large residual (much higher BAC than predicted), but since there is no clear pattern (trend) in this plot it looks like our regression model adequately describes the relationship between number of beers and BAC.</p>
<ul>
<li>Is the magnitude of the scatter around the horizontal 0-line in the residuals plot greater than, less than, or the same as the magnitude of the scatter around the regression line in the scatterplot?</li>
</ul>
<details><summary><red>Click for answer</red></summary><em>Answer:</em> The same! The residuals plot is only a “detrended” scatterplot, meaning the vertical distances between a point and the regression line on the scatterplot or a point and the 0-line on the residuals plot are exactly the same. The residual plot looks more scattered because the trend is removed and the scale of the y-axis compressed.
</details><p><br></p>
</div>
<div id="k-identifying-points" class="section level3" number="13.1.12">
<h3>
<span class="header-section-number">13.1.12</span> (k) Identifying points<a class="anchor" aria-label="anchor" href="#k-identifying-points"><i class="fas fa-link"></i></a>
</h3>
<p>We can use the functions <code>filter</code> and <code>row_number</code> from the <code>dplyr</code> package to find the index of Beers equal to 9.</p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use `which` to find the index of Beers equal to 9</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">bac</span><span class="op">$</span><span class="va">Beers</span> <span class="op">==</span> <span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">index</span></span></code></pre></div>
<pre><code>[1] 3</code></pre>
<details><summary><red>Click for answer</red></summary><em>Answer:</em> Row 3.
</details><p><br></p>
<p>What is the row number of the case with the most negative residual? We could eyeball the graph to see that the most negative residual is less than -0.02:</p>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find residuals less than -0.02</span></span>
<span><span class="va">resid_less_than_neg_002</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.02</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span><span class="op">[</span><span class="va">resid_less_than_neg_002</span><span class="op">]</span></span></code></pre></div>
<pre><code>          9          10          14 
-0.02119068 -0.02711821 -0.02304573 </code></pre>
<p>But this identifies 3 cases. We also can see that the lowest residual drank 5 beers. We can add this statement to the original one using the “and” sign <code>&amp;</code>:</p>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># which case had resid less than -0.02 AND drank 5 beers</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.02</span> <span class="op">&amp;</span> <span class="va">bac</span><span class="op">$</span><span class="va">Beers</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>         10 
-0.02711821 </code></pre>
</div>
<div id="l-checking-outlier-influence" class="section level3" number="13.1.13">
<h3>
<span class="header-section-number">13.1.13</span> (l) Checking outlier influence<a class="anchor" aria-label="anchor" href="#l-checking-outlier-influence"><i class="fas fa-link"></i></a>
</h3>
<p>Will the regression line slope increase, decrease or stay the same if we remove case 3, the 9 beer case, from our model?</p>
<p>Check your answer by adding <code>subset = -3</code> to the <code>lm</code> command (this removes row 3):</p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define a different linear model with row 3 removed </span></span>
<span><span class="va">bac.lm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data<span class="op">=</span><span class="va">bac</span>, subset <span class="op">=</span> <span class="op">-</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare the two models</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bac.lm2</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac, subset = -3)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.023685 -0.010068 -0.003685  0.011985  0.027208 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 2.481e-05  1.088e-02   0.002    0.998    
Beers       1.455e-02  2.216e-03   6.568  1.8e-05 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01624 on 13 degrees of freedom
Multiple R-squared:  0.7684,    Adjusted R-squared:  0.7506 
F-statistic: 43.14 on 1 and 13 DF,  p-value: 1.802e-05</code></pre>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.027118 -0.017350  0.001773  0.008623  0.041027 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.012701   0.012638  -1.005    0.332    
Beers        0.017964   0.002402   7.480 2.97e-06 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02044 on 14 degrees of freedom
Multiple R-squared:  0.7998,    Adjusted R-squared:  0.7855 
F-statistic: 55.94 on 1 and 14 DF,  p-value: 2.969e-06</code></pre>
<ul>
<li>After removing case 3, how has the slope changed? Explain the why the change occurred.</li>
</ul>
<details><summary><red>Click for answer</red></summary><p><em>Answer:</em> The slope drops from 0.0180 to 0.0146. Explanation given above.</p>
<ul>
<li>After removing case 3, how has the <span class="math inline">\(R^2\)</span> changed? Explain the why the change occurred.</li>
</ul></details><p><br></p>
<details><summary><red>Click for answer</red></summary><em>Answer:</em> The <span class="math inline">\(R^2\)</span> descreases from 79.9% to 76.8%. This small decrease happens because case 3 actually enhances the overall linear trend and removing it results is a slight decrease to correlation and <span class="math inline">\(R^2\)</span>.
</details><p><br></p>
</div>
<div id="m-adding-a-categorical-variable-to-your-plot" class="section level3" number="13.1.14">
<h3>
<span class="header-section-number">13.1.14</span> (m) Adding a categorical variable to your plot<a class="anchor" aria-label="anchor" href="#m-adding-a-categorical-variable-to-your-plot"><i class="fas fa-link"></i></a>
</h3>
<p>We can create a scatterplot with plotting symbols color coded by a categorical grouping variable using <code>ggplot2</code> package. We use the <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> plot geometry to get a scatterplot with the <code>x</code>, <code>y</code>, and <code>color</code> aesthetics specified. Here we look at the <code>BAC</code> vs. <code>Beers</code> plot with <code>Gender</code> added:</p>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bac</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Beers</span>, y<span class="op">=</span><span class="va">BAC</span>, color<span class="op">=</span><span class="va">Gender</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-18-1.png" width="100%"></div>
<ul>
<li>Are the associations similiar? (form, strength, direction)</li>
</ul>
<details><summary><red>Click for answer</red></summary><em>Answer:</em> Both females and males have similar strong, positive linear associations.
</details><p><br></p>
</div>
<div id="n-regression-lines-by-groups" class="section level3" number="13.1.15">
<h3>
<span class="header-section-number">13.1.15</span> (n) Regression lines by groups<a class="anchor" aria-label="anchor" href="#n-regression-lines-by-groups"><i class="fas fa-link"></i></a>
</h3>
<p>A quick way to get the male and female regression line formulas for part (c) is to add a <code>subset</code> argument to the <code>lm</code> command:</p>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit linear regression model for female</span></span>
<span><span class="va">bac.lm.female</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data <span class="op">=</span> <span class="va">bac</span>, subset <span class="op">=</span> <span class="va">Gender</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span></span>
<span><span class="va">bac.lm.female</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac, subset = Gender == "female")

Coefficients:
(Intercept)        Beers  
   -0.01567      0.02067  </code></pre>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit linear regression model for male</span></span>
<span><span class="va">bac.lm.male</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data <span class="op">=</span> <span class="va">bac</span>, subset <span class="op">=</span> <span class="va">Gender</span> <span class="op">==</span> <span class="st">"male"</span><span class="op">)</span></span>
<span><span class="va">bac.lm.male</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac, subset = Gender == "male")

Coefficients:
(Intercept)        Beers  
  -0.009785     0.015341  </code></pre>
<ul>
<li>What is the regression line for females? for males?</li>
</ul>
<details><summary><red>Click for answer</red></summary><em>Answer:</em> For females: <span class="math inline">\(\widehat{BAC} = -0.016 +0.021(BAC)\)</span> and for males: <span class="math inline">\(\widehat{BAC} = -0.01 +0.015(BAC)\)</span>
</details><p><br></p>
<ul>
<li>Which gender has the largest slope? What does this suggest about the relationship between number of beers and BAC for this gender?</li>
</ul>
<details><summary><red>Click for answer</red></summary><p><em>Answer:</em> The slope for females is slightly higher. This shows that the effect of one more beer on predicted BAC in females is larger than males (a 0.021 increase vs. a 0.015 increase).</p>
<p>Another way to obtain regression models by <code>Gender</code> is to split the data set in a female and male data set, then run your <code>lm</code> on these two data sets. The benefit of this method is you can then create a residuals plot for your model much easier than the quicker method above:</p>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter data for female</span></span>
<span><span class="va">bac_female</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bac</span>, <span class="va">Gender</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit linear regression model for female</span></span>
<span><span class="va">bac_lm_female</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data <span class="op">=</span> <span class="va">bac_female</span><span class="op">)</span></span>
<span><span class="va">bac_lm_female</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac_female)

Coefficients:
(Intercept)        Beers  
   -0.01567      0.02067  </code></pre>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter data for male</span></span>
<span><span class="va">bac_male</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">bac</span>, <span class="va">Gender</span> <span class="op">==</span> <span class="st">"male"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit linear regression model for male</span></span>
<span><span class="va">bac_lm_male</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data <span class="op">=</span> <span class="va">bac_male</span><span class="op">)</span></span>
<span><span class="va">bac_lm_male</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac_male)

Coefficients:
(Intercept)        Beers  
  -0.009785     0.015341  </code></pre>
</details><p><br></p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="class-activity-5.html"><span class="header-section-number">12</span> Class Activity 5</a></div>
<div class="next"><a href="class-activity-7.html"><span class="header-section-number">14</span> Class Activity 7</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#class-activity-6"><span class="header-section-number">13</span> Class Activity 6</a></li>
<li>
<a class="nav-link" href="#your-turn-1-3"><span class="header-section-number">13.1</span> Your Turn 1</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#beer-example"><span class="header-section-number">13.1.1</span> Beer Example</a></li>
<li><a class="nav-link" href="#a-always-start-with-a-visual"><span class="header-section-number">13.1.2</span> (a) Always start with a visual!!!!</a></li>
<li><a class="nav-link" href="#b-computing-correlation"><span class="header-section-number">13.1.3</span> (b) Computing correlation</a></li>
<li><a class="nav-link" href="#c-fitting-a-regression-line"><span class="header-section-number">13.1.4</span> (c) Fitting a regression line</a></li>
<li><a class="nav-link" href="#d-interpret-the-slope-in-context."><span class="header-section-number">13.1.5</span> (d) Interpret the slope in context.</a></li>
<li><a class="nav-link" href="#e-interpret-the-intercept-in-context-if-it-makes-sense-to-do-so."><span class="header-section-number">13.1.6</span> (e) Interpret the intercept in context, if it makes sense to do so.</a></li>
<li><a class="nav-link" href="#f-if-your-friend-at-ohio-state-drank-2-beers-what-would-you-predict-their-bac-to-be"><span class="header-section-number">13.1.7</span> (f) If your friend at Ohio State drank 2 beers, what would you predict their BAC to be?</a></li>
<li><a class="nav-link" href="#g-find-the-residual-for-the-student-in-the-dataset-who-drank-2-beers-and-had-a-bac-of-0.03."><span class="header-section-number">13.1.8</span> (g) Find the residual for the student in the dataset who drank 2 beers and had a BAC of 0.03.</a></li>
<li><a class="nav-link" href="#h-getting-residuals-in-r"><span class="header-section-number">13.1.9</span> (h) Getting residuals in R</a></li>
<li><a class="nav-link" href="#i-getting-r2-value"><span class="header-section-number">13.1.10</span> (i) Getting \(R^2\) value</a></li>
<li><a class="nav-link" href="#j-making-a-residuals-plot"><span class="header-section-number">13.1.11</span> (j) Making a residuals plot</a></li>
<li><a class="nav-link" href="#k-identifying-points"><span class="header-section-number">13.1.12</span> (k) Identifying points</a></li>
<li><a class="nav-link" href="#l-checking-outlier-influence"><span class="header-section-number">13.1.13</span> (l) Checking outlier influence</a></li>
<li><a class="nav-link" href="#m-adding-a-categorical-variable-to-your-plot"><span class="header-section-number">13.1.14</span> (m) Adding a categorical variable to your plot</a></li>
<li><a class="nav-link" href="#n-regression-lines-by-groups"><span class="header-section-number">13.1.15</span> (n) Regression lines by groups</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/Class_Activity_6.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/Class_Activity_6.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Stat 120</strong>" was written by Deepak Bastola. It was last built on 2023-04-27.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>

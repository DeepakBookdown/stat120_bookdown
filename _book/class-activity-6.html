<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Class Activity 6 | Stat 120</title>
<meta name="author" content="Deepak Bastola">
<meta name="description" content="6.1 Your Turn 1  6.1.1 Beer Example A study of 16 Ohio State University students looked at the relationship between the number of beers a student consumes and their blood alcohol content (BAC) 30...">
<meta name="generator" content="bookdown 0.31 with bs4_book()">
<meta property="og:title" content="Chapter 6 Class Activity 6 | Stat 120">
<meta property="og:type" content="book">
<meta property="og:description" content="6.1 Your Turn 1  6.1.1 Beer Example A study of 16 Ohio State University students looked at the relationship between the number of beers a student consumes and their blood alcohol content (BAC) 30...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Class Activity 6 | Stat 120">
<meta name="twitter:description" content="6.1 Your Turn 1  6.1.1 Beer Example A study of 16 Ohio State University students looked at the relationship between the number of beers a student consumes and their blood alcohol content (BAC) 30...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.1/transition.js"></script><script src="libs/bs3compat-0.4.1/tabs.js"></script><script src="libs/bs3compat-0.4.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Stat 120</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About</a></li>
<li><a class="" href="class-activity-1.html"><span class="header-section-number">1</span> Class Activity 1</a></li>
<li><a class="" href="class-activity-2.html"><span class="header-section-number">2</span> Class Activity 2</a></li>
<li><a class="" href="class-activity-3.html"><span class="header-section-number">3</span> Class Activity 3</a></li>
<li><a class="" href="class-activity-4.html"><span class="header-section-number">4</span> Class Activity 4</a></li>
<li><a class="" href="class-activity-5.html"><span class="header-section-number">5</span> Class Activity 5</a></li>
<li><a class="active" href="class-activity-6.html"><span class="header-section-number">6</span> Class Activity 6</a></li>
<li class="book-part">Basics R</li>
<li><a class="" href="what-is-r.html"><span class="header-section-number">8</span> What is R?</a></li>
<li><a class="" href="r-markdown.html"><span class="header-section-number">9</span> R Markdown</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="class-activity-6" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Class Activity 6<a class="anchor" aria-label="anchor" href="#class-activity-6"><i class="fas fa-link"></i></a>
</h1>
<div id="your-turn-1-4" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Your Turn 1<a class="anchor" aria-label="anchor" href="#your-turn-1-4"><i class="fas fa-link"></i></a>
</h2>
<div id="beer-example" class="section level3" number="6.1.1">
<h3>
<span class="header-section-number">6.1.1</span> Beer Example<a class="anchor" aria-label="anchor" href="#beer-example"><i class="fas fa-link"></i></a>
</h3>
<p>A study of 16 Ohio State University students looked at the relationship between the number of beers a student consumes and their blood alcohol content (BAC) 30 minutes after their last beer. The regression information from R to predict BAC from number of beers consumed is given below.</p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"http://math.carleton.edu/kstclair/data/BAC.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="a-always-start-with-a-visual" class="section level3" number="6.1.2">
<h3>
<span class="header-section-number">6.1.2</span> (a) Always start with a visual!!!!<a class="anchor" aria-label="anchor" href="#a-always-start-with-a-visual"><i class="fas fa-link"></i></a>
</h3>
<p>Plot the response (BAC) on the y-axis and the explantory (“predictor”) on the x-axis.</p>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data<span class="op">=</span><span class="va">bac</span><span class="op">)</span>  </span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-2-1.png" width="100%"></div>
<ul>
<li>Is there a relationship?
<ul>
<li>direction?</li>
<li>strength?</li>
<li>form?</li>
</ul>
</li>
</ul>
<p>You can modify this basic graph by adding a title and changing the plotting symbol. The <code>pch=19</code> argument changes the symbols to filled circles.</p>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data<span class="op">=</span><span class="va">bac</span>, pch<span class="op">=</span><span class="fl">19</span>, </span>
<span>     main<span class="op">=</span><span class="st">"Beer and BAC"</span>, xlab<span class="op">=</span><span class="st">"Number of beers drank"</span>, ylab <span class="op">=</span> <span class="st">"Blood Alcohol Content"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-3-1.png" width="100%"></div>
</div>
<div id="b-computing-correlation" class="section level3" number="6.1.3">
<h3>
<span class="header-section-number">6.1.3</span> (b) Computing correlation<a class="anchor" aria-label="anchor" href="#b-computing-correlation"><i class="fas fa-link"></i></a>
</h3>
<p>Since the <em>form</em> of the relationship is linear, we can use <strong>correlation</strong> to measure its strength:</p>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">bac</span><span class="op">$</span><span class="va">BAC</span>, <span class="va">bac</span><span class="op">$</span><span class="va">Beers</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.8943381</code></pre>
</div>
<div id="c-fitting-a-regression-line" class="section level3" number="6.1.4">
<h3>
<span class="header-section-number">6.1.4</span> (c) Fitting a regression line<a class="anchor" aria-label="anchor" href="#c-fitting-a-regression-line"><i class="fas fa-link"></i></a>
</h3>
<p>We use the <code>lm(y ~ x, data=mydata)</code> function to fit a <strong>l</strong>inear (regression) <strong>m</strong>odel for a response y given an explanatory variable x. This command creates a <strong>linear model object</strong> that needs to be assigned a name, here we call it <code>bac.lm</code>. You can get the slope and intercept by typing out the object name:</p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bac.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data<span class="op">=</span><span class="va">bac</span><span class="op">)</span></span>
<span><span class="va">bac.lm</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac)

Coefficients:
(Intercept)        Beers  
   -0.01270      0.01796  </code></pre>
<ul>
<li>After running the <code>lm</code> command above in your R console, check the <strong>Environment</strong> tab to see that the object <code>bac.lm</code> is now one of the objects stored in R’s memory (for this session of Rstudio).</li>
<li>Write down the fitted regression equation to predict BAC from number of beers.</li>
</ul>
<p><em>Answer:</em> <span class="math inline">\(\hat{y} = \ldots\)</span></p>
<ul>
<li>You can add this regression line to your scatterplot from part (a) by creating the plot and using the <code>abline</code> command:</li>
</ul>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Need to call the plot function again!!</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data<span class="op">=</span><span class="va">bac</span>, pch<span class="op">=</span><span class="fl">19</span>, </span>
<span>     main<span class="op">=</span><span class="st">"Beer and BAC"</span>, xlab<span class="op">=</span><span class="st">"Number of beers drank"</span>, ylab <span class="op">=</span> <span class="st">"Blood Alcohol Content"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span> <span class="co"># adds regression line to the plot above</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-6-1.png" width="100%"></div>
</div>
<div id="d-interpret-the-slope-in-context." class="section level3" number="6.1.5">
<h3>
<span class="header-section-number">6.1.5</span> (d) Interpret the slope in context.<a class="anchor" aria-label="anchor" href="#d-interpret-the-slope-in-context."><i class="fas fa-link"></i></a>
</h3>
<p><em>Answer:</em> Drinking one more beer is associated with a 0.0180 unit increase in predicted BAC.</p>
</div>
<div id="e-interpret-the-intercept-in-context-if-it-makes-sense-to-do-so." class="section level3" number="6.1.6">
<h3>
<span class="header-section-number">6.1.6</span> (e) Interpret the intercept in context, if it makes sense to do so.<a class="anchor" aria-label="anchor" href="#e-interpret-the-intercept-in-context-if-it-makes-sense-to-do-so."><i class="fas fa-link"></i></a>
</h3>
<p><em>Answer:</em> The intercept is -0.0127. A student who drinks 0 beers would be predicted to have a negative blood alcohol content. This is not possible so the intercept does not make sense in this context, but the intercept is included in the model to get the best fit line for the data collected.</p>
</div>
<div id="f-if-your-friend-at-ohio-state-drank-2-beers-what-would-you-predict-their-bac-to-be" class="section level3" number="6.1.7">
<h3>
<span class="header-section-number">6.1.7</span> (f) If your friend at Ohio State drank 2 beers, what would you predict their BAC to be?<a class="anchor" aria-label="anchor" href="#f-if-your-friend-at-ohio-state-drank-2-beers-what-would-you-predict-their-bac-to-be"><i class="fas fa-link"></i></a>
</h3>
<p><em>Answer:</em> The predicted BAC is
<span class="math display">\[
\widehat{BAC} = -0.0127 + 0.0180(2) = 0.0233.
\]</span></p>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y.hat</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.0127</span> <span class="op">+</span> <span class="fl">0.0180</span><span class="op">*</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> </span>
<span><span class="va">y.hat</span></span></code></pre></div>
<pre><code>[1] 0.0233</code></pre>
</div>
<div id="g-find-the-residual-for-the-student-in-the-dataset-who-drank-2-beers-and-had-a-bac-of-0.03." class="section level3" number="6.1.8">
<h3>
<span class="header-section-number">6.1.8</span> (g) Find the residual for the student in the dataset who drank 2 beers and had a BAC of 0.03.<a class="anchor" aria-label="anchor" href="#g-find-the-residual-for-the-student-in-the-dataset-who-drank-2-beers-and-had-a-bac-of-0.03."><i class="fas fa-link"></i></a>
</h3>
<p><em>Answer:</em> The residual is
<span class="math display">\[
BAC - \widehat{BAC} = .03 - .0233=0.0067
\]</span></p>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0.03</span> <span class="op">-</span> <span class="op">(</span><span class="op">-</span><span class="fl">0.0127</span> <span class="op">+</span> <span class="fl">0.0180</span><span class="op">*</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<pre><code>[1] 0.0067</code></pre>
</div>
<div id="h-getting-residuals-in-r" class="section level3" number="6.1.9">
<h3>
<span class="header-section-number">6.1.9</span> (h) Getting residuals in R<a class="anchor" aria-label="anchor" href="#h-getting-residuals-in-r"><i class="fas fa-link"></i></a>
</h3>
<p>We can use the <code>resid</code> command to get the residuals for each case in the data set:</p>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># part h</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span></span></code></pre></div>
<pre><code>           1            2            3            4 
 0.022881795  0.006773080  0.041026747 -0.011009491 
           5            6            7            8 
-0.001190682 -0.018045729  0.028809318 -0.017118205 
           9           10           11           12 
-0.021190682 -0.027118205  0.010845557  0.004918033 
          13           14           15           16 
 0.007881795 -0.023045729  0.004736842 -0.009154443 </code></pre>
<p>Notice that case 2 in the data drank 2 beers and had a BAC recorded as 0.03. We can see that their residual value matches our answer to (g) up to some rounding error.</p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># part h</span></span>
<span><span class="va">bac</span><span class="op">$</span><span class="va">BAC</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<pre><code>[1] 0.03</code></pre>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bac</span><span class="op">$</span><span class="va">Beers</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<pre><code>[1] 2</code></pre>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<pre><code>         2 
0.00677308 </code></pre>
</div>
<div id="i-getting-r2-value" class="section level3" number="6.1.10">
<h3>
<span class="header-section-number">6.1.10</span> (i) Getting <span class="math inline">\(R^2\)</span> value<a class="anchor" aria-label="anchor" href="#i-getting-r2-value"><i class="fas fa-link"></i></a>
</h3>
<p>You can use the <code>summary</code> command on an <code>lm</code> object to get a more detailed print out of your linear model, along with the <span class="math inline">\(R^2\)</span> value for your model:</p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.027118 -0.017350  0.001773  0.008623  0.041027 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.012701   0.012638  -1.005    0.332    
Beers        0.017964   0.002402   7.480 2.97e-06 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02044 on 14 degrees of freedom
Multiple R-squared:  0.7998,    Adjusted R-squared:  0.7855 
F-statistic: 55.94 on 1 and 14 DF,  p-value: 2.969e-06</code></pre>
</div>
<div id="j-making-a-residuals-plot" class="section level3" number="6.1.11">
<h3>
<span class="header-section-number">6.1.11</span> (j) Making a residuals plot<a class="anchor" aria-label="anchor" href="#j-making-a-residuals-plot"><i class="fas fa-link"></i></a>
</h3>
<p>The regression of <code>BAC</code> on <code>Beers</code> has a residuals plot that plots the model’s residuals on the y-axis and the explantory (“predictor”) on the x-axis. We add a horizontal reference line (the detrended regression line) with the <code>abline(h=0)</code> command:</p>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># code for residual plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span> <span class="op">~</span> <span class="va">Beers</span>, data<span class="op">=</span><span class="va">bac</span>, pch<span class="op">=</span><span class="fl">19</span>, main <span class="op">=</span> <span class="st">"residuals plot"</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-12-1.png" width="100%"></div>
<p><strong>Interpret:</strong> There is one case of 9 beers with a large residual (much higher BAC than predicted), but since there is no clear pattern (trend) in this plot it looks like our regression model adequately describes the relationship between number of beers and BAC.</p>
<ul>
<li>Is the magnitude of the scatter around the horizontal 0-line in the residuals plot greater than, less than, or the same as the magnitude of the scatter around the regression line in the scatterplot?</li>
</ul>
<p><em>Answer:</em> The same! The residuals plot is only a “detrended” scatterplot, meaning the vertical distances between a point and the regression line on the scatterplot or a point and the 0-line on the residuals plot are exactly the same. The residual plot looks more scattered because the trend is removed and the scale of the y-axis compressed.</p>
</div>
<div id="k-identifying-points" class="section level3" number="6.1.12">
<h3>
<span class="header-section-number">6.1.12</span> (k) Identifying points<a class="anchor" aria-label="anchor" href="#k-identifying-points"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>which</code> command can be used to identify points by their row number in a scatterplot.</p>
<p>We can use <code>==</code> to see which case drank exactly 9 beers. Which is the row number of the case that drank 9 beers?</p>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data<span class="op">=</span><span class="va">bac</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span>  </span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-13-1.png" width="100%"></div>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">bac</span><span class="op">$</span><span class="va">Beers</span> <span class="op">==</span> <span class="fl">9</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 3</code></pre>
<p><em>Answer:</em> Row 3.</p>
<p>What is the row number of the case with the most negative residual?</p>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span> <span class="op">~</span> <span class="va">Beers</span>, data<span class="op">=</span><span class="va">bac</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-14-1.png" width="100%"></div>
<p>We could eyeball the graph to see that the most negative residual is less than -0.02:</p>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># which case has resid less than -0.02?</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.02</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>          9          10          14 
-0.02119068 -0.02711821 -0.02304573 </code></pre>
<p>But this identifies 3 cases. We also can see that the lowest residual drank 5 beers. We can add this statement to the original one using the “and” sign <code>&amp;</code>:</p>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># which case had resid less than -0.02 AND drank 5 beers</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.02</span> <span class="op">&amp;</span> <span class="va">bac</span><span class="op">$</span><span class="va">Beers</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>         10 
-0.02711821 </code></pre>
</div>
<div id="l-checking-outlier-influence" class="section level3" number="6.1.13">
<h3>
<span class="header-section-number">6.1.13</span> (l) Checking outlier influence<a class="anchor" aria-label="anchor" href="#l-checking-outlier-influence"><i class="fas fa-link"></i></a>
</h3>
<p>Will the regression line slope increase, decrease or stay the same if we remove case 3, the 9 beer case, from our model?</p>
<p>Check your answer by adding <code>subset = -3</code> to the <code>lm</code> command (this removes row 3):</p>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define a different linear model with row 3 removed </span></span>
<span><span class="va">bac.lm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data<span class="op">=</span><span class="va">bac</span>, subset <span class="op">=</span> <span class="op">-</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare the two models</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bac.lm2</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac, subset = -3)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.023685 -0.010068 -0.003685  0.011985  0.027208 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 2.481e-05  1.088e-02   0.002    0.998    
Beers       1.455e-02  2.216e-03   6.568  1.8e-05 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01624 on 13 degrees of freedom
Multiple R-squared:  0.7684,    Adjusted R-squared:  0.7506 
F-statistic: 43.14 on 1 and 13 DF,  p-value: 1.802e-05</code></pre>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bac.lm</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.027118 -0.017350  0.001773  0.008623  0.041027 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.012701   0.012638  -1.005    0.332    
Beers        0.017964   0.002402   7.480 2.97e-06 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02044 on 14 degrees of freedom
Multiple R-squared:  0.7998,    Adjusted R-squared:  0.7855 
F-statistic: 55.94 on 1 and 14 DF,  p-value: 2.969e-06</code></pre>
<ul>
<li>After removing case 3, how has the slope changed? Explain the why the change occurred.</li>
</ul>
<p><em>Answer:</em> The slope drops from 0.0180 to 0.0146. Explanation given above.</p>
<ul>
<li>After removing case 3, how has the <span class="math inline">\(R^2\)</span> changed? Explain the why the change occurred.</li>
</ul>
<p><em>Answer:</em> The <span class="math inline">\(R^2\)</span> descreases from 79.9% to 76.8%. This small decrease happens because case 3 actually enhances the overall linear trend and removing it results is a slight decrease to correlation and <span class="math inline">\(R^2\)</span>.</p>
</div>
<div id="m-adding-a-categorical-variable-to-your-plot" class="section level3" number="6.1.14">
<h3>
<span class="header-section-number">6.1.14</span> (m) Adding a categorical variable to your plot<a class="anchor" aria-label="anchor" href="#m-adding-a-categorical-variable-to-your-plot"><i class="fas fa-link"></i></a>
</h3>
<p>We can create a scatterplot with plotting symbols color coded by a categorical grouping variable using <code>ggplot2</code> package. We use the <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> plot geometry to get a scatterplot with the <code>x</code>, <code>y</code>, and <code>color</code> aesthetics specified. Here we look at the <code>BAC</code> vs. <code>Beers</code> plot with <code>Gender</code> added:</p>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bac</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Beers</span>, y<span class="op">=</span><span class="va">BAC</span>, color<span class="op">=</span><span class="va">Gender</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-19-1.png" width="100%"></div>
<ul>
<li>Are the associations similiar? (form, strength, direction)</li>
</ul>
<p><em>Answer:</em> Both females and males have similar strong, positive linear associations.</p>
</div>
<div id="n-regression-lines-by-groups" class="section level3" number="6.1.15">
<h3>
<span class="header-section-number">6.1.15</span> (n) Regression lines by groups<a class="anchor" aria-label="anchor" href="#n-regression-lines-by-groups"><i class="fas fa-link"></i></a>
</h3>
<p>A quick way to get the male and female regression line formulas for part (c) is to add a <code>subset</code> argument to the <code>lm</code> command:</p>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bac.lm.female</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data<span class="op">=</span><span class="va">bac</span>, subset <span class="op">=</span> <span class="va">Gender</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span></span>
<span><span class="va">bac.lm.female</span> </span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac, subset = Gender == "female")

Coefficients:
(Intercept)        Beers  
   -0.01567      0.02067  </code></pre>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># enter code for the male model</span></span>
<span></span>
<span><span class="va">bac.lm.male</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data<span class="op">=</span><span class="va">bac</span>, subset <span class="op">=</span> <span class="va">Gender</span> <span class="op">==</span> <span class="st">"male"</span><span class="op">)</span></span>
<span><span class="va">bac.lm.male</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac, subset = Gender == "male")

Coefficients:
(Intercept)        Beers  
  -0.009785     0.015341  </code></pre>
<ul>
<li>What is the regression line for females? for males?</li>
</ul>
<p><em>Answer:</em> For females: <span class="math inline">\(\widehat{BAC} = -0.016 +0.021(BAC)\)</span> and for males: <span class="math inline">\(\widehat{BAC} = -0.01 +0.015(BAC)\)</span></p>
<ul>
<li>Which gender has the largest slope? What does this suggest about the relationship between number of beers and BAC for this gender?</li>
</ul>
<p><em>Answer:</em> The slope for females is slightly higher. This shows that the effect of one more beer on predicted BAC in females is larger than males (a 0.021 increase vs. a 0.015 increase).</p>
<p>Another way to obtain regression models by <code>Gender</code> is to split the data set in a female and male data set, then run your <code>lm</code> on these two data sets. The benefit of this method is you can then create a residuals plot for your model much easier than the quicker method above:</p>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bac.female</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">bac</span>, sub <span class="op">=</span> <span class="va">Gender</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data<span class="op">=</span><span class="va">bac.female</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac.female)

Coefficients:
(Intercept)        Beers  
   -0.01567      0.02067  </code></pre>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bac.male</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">bac</span>, sub <span class="op">=</span> <span class="va">Gender</span> <span class="op">==</span> <span class="st">"male"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BAC</span> <span class="op">~</span> <span class="va">Beers</span>, data<span class="op">=</span><span class="va">bac.male</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BAC ~ Beers, data = bac.male)

Coefficients:
(Intercept)        Beers  
  -0.009785     0.015341  </code></pre>
</div>
<div id="mice-mass-example" class="section level3" number="6.1.16">
<h3>
<span class="header-section-number">6.1.16</span> Mice Mass Example<a class="anchor" aria-label="anchor" href="#mice-mass-example"><i class="fas fa-link"></i></a>
</h3>
<p>The time of day in which calories are consumed can affect weight gain. At least, that appears to be true in mice. Mice normally eat all their calories at night, but when mice ate some of their calories during the day (when mice are supposed to be sleeping), they gained more weight even though all the mice ate the same total amount of calories. Here we look at the regression of body mass gain in grams, <code>BMGain</code>, against the percent of calories eaten during the day, <code>DayPct</code> for a study involving 27 mice. The R commands needed to answer the questions below are:</p>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"http://math.carleton.edu/Stats215/Textbook/LightatNight4Weeks.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">BMGain</span> <span class="op">~</span> <span class="va">DayPct</span>, data<span class="op">=</span><span class="va">mice</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span>
<span><span class="va">mice.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">BMGain</span> <span class="op">~</span> <span class="va">DayPct</span>, data<span class="op">=</span><span class="va">mice</span><span class="op">)</span></span>
<span><span class="va">mice.lm</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BMGain ~ DayPct, data = mice)

Coefficients:
(Intercept)       DayPct  
     1.1128       0.1273  </code></pre>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">mice</span><span class="op">$</span><span class="va">BMGain</span>, <span class="va">mice</span><span class="op">$</span><span class="va">DayPct</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.7398623</code></pre>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">mice.lm</span><span class="op">)</span> <span class="co"># adds regression line to previously created scatterplot</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-22-1.png" width="100%"></div>
</div>
<div id="a-what-are-the-coordinates-roughly-of-the-case-with-the-largest-positive-residual" class="section level3" number="6.1.17">
<h3>
<span class="header-section-number">6.1.17</span> (a) What are the coordinates (roughly) of the case with the largest positive residual?<a class="anchor" aria-label="anchor" href="#a-what-are-the-coordinates-roughly-of-the-case-with-the-largest-positive-residual"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mice</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">mice.lm</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">mice.lm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<pre><code>   Light BMGain Corticosterone DayPct Consumption
25    LL   17.4         66.679 81.636       7.177
   GlucoseInt   GTT15  GTT120 Activity
25        Yes 435.644 405.941     6702</code></pre>
<p><em>Answer:</em> The case with the largest residual is located at about 80% calories and 17g body mass gain. We can find which row this corresponds to using the <code>which</code> command shown below.</p>
</div>
<div id="b-what-are-the-coordinates-roughly-of-the-case-with-the-most-negative-residual" class="section level3" number="6.1.18">
<h3>
<span class="header-section-number">6.1.18</span> (b) What are the coordinates (roughly) of the case with the most negative residual?<a class="anchor" aria-label="anchor" href="#b-what-are-the-coordinates-roughly-of-the-case-with-the-most-negative-residual"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mice</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">mice.lm</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">mice.lm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<pre><code>   Light BMGain Corticosterone DayPct Consumption
10    DM   3.42         208.26 55.051       3.857
   GlucoseInt   GTT15  GTT120 Activity
10         No 271.717 148.485     1084</code></pre>
<p><em>Answer:</em> The case with the most negative residual is located at about 55% calories and 3g body mass gain. We can find which row this corresponds to using the <code>which</code> command shown below. The code below also highlights the cases in (a) with a circle and (b) with a square.</p>
</div>
<div id="c-what-is-the-predicted-body-mass-gain-for-a-mouse-that-eats-50-of-its-calories-during-the-day" class="section level3" number="6.1.19">
<h3>
<span class="header-section-number">6.1.19</span> (c) What is the predicted body mass gain for a mouse that eats 50% of its calories during the day?<a class="anchor" aria-label="anchor" href="#c-what-is-the-predicted-body-mass-gain-for-a-mouse-that-eats-50-of-its-calories-during-the-day"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math display">\[
\widehat{BMGain} =1.1128+0.1273(50)=7.48
\]</span></p>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1.1128</span> <span class="op">+</span> <span class="fl">.1273</span><span class="op">*</span><span class="fl">50</span></span></code></pre></div>
<pre><code>[1] 7.4778</code></pre>
<p><em>Answer:</em> A mouse that eats 50% of its calories during the day is predicted to gain 7.48 grams.</p>
</div>
<div id="d-find-the-residual-for-the-mouse-who-ate-48.3-of-its-calories-during-the-day-and-gained-5.82-grams." class="section level3" number="6.1.20">
<h3>
<span class="header-section-number">6.1.20</span> (d) Find the residual for the mouse who ate 48.3% of its calories during the day and gained 5.82 grams.<a class="anchor" aria-label="anchor" href="#d-find-the-residual-for-the-mouse-who-ate-48.3-of-its-calories-during-the-day-and-gained-5.82-grams."><i class="fas fa-link"></i></a>
</h3>
<p><em>Answer:</em> We first find the predicted body mass gain:
<span class="math display">\[
\widehat{BMGain} = 1.1128+0.1273(48.3)=7.26
\]</span></p>
<p>The residual is then:<br><span class="math display">\[
Residual = BMGain  -   \widehat{BMGain} =  5.82 – 7.26 = –1.44.
\]</span></p>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1.1128</span> <span class="op">+</span> <span class="fl">.1273</span><span class="op">*</span><span class="fl">48.3</span></span></code></pre></div>
<pre><code>[1] 7.26139</code></pre>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">5.82</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1.1128</span> <span class="op">+</span> <span class="fl">.1273</span><span class="op">*</span><span class="fl">48.3</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] -1.44139</code></pre>
</div>
<div id="e-interpret-the-slope-of-the-regression-line-in-context." class="section level3" number="6.1.21">
<h3>
<span class="header-section-number">6.1.21</span> (e) Interpret the slope of the regression line in context.<a class="anchor" aria-label="anchor" href="#e-interpret-the-slope-of-the-regression-line-in-context."><i class="fas fa-link"></i></a>
</h3>
<p><em>Answer:</em> The slope is 0.1273. When a mouse eats one more percent of its calories during the day, its predicted body mass gain goes up by 0.1273 grams.</p>
</div>
<div id="f-interpret-the-intercept-of-the-line-in-context-if-it-makes-sense-to-do-so." class="section level3" number="6.1.22">
<h3>
<span class="header-section-number">6.1.22</span> (f) Interpret the intercept of the line in context, if it makes sense to do so.<a class="anchor" aria-label="anchor" href="#f-interpret-the-intercept-of-the-line-in-context-if-it-makes-sense-to-do-so."><i class="fas fa-link"></i></a>
</h3>
<p><em>Answer:</em> The intercept is 1.1128. A mouse who eats 0% of its calories during the day (and all of them at night when a mouse normally eats all its food) is predicted to gain 1.11 grams. But this would be <strong>extrapolation</strong> because the range of observed percents is, roughly, 20-90. It does not make sense to interpret the intercept in this context.</p>
</div>
<div id="g-use-the-correlation-value-to-compute-r2-then-interpret-in-context-the-r2-value-for-this-model." class="section level3" number="6.1.23">
<h3>
<span class="header-section-number">6.1.23</span> (g) Use the correlation value to compute <span class="math inline">\(R^2\)</span>, then interpret (in context) the <span class="math inline">\(R^2\)</span> value for this model.<a class="anchor" aria-label="anchor" href="#g-use-the-correlation-value-to-compute-r2-then-interpret-in-context-the-r2-value-for-this-model."><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">0.7398623</span></span>
<span><span class="va">r</span><span class="op">^</span><span class="fl">2</span></span></code></pre></div>
<pre><code>[1] 0.5473962</code></pre>
</div>
<div id="h-get-the-value-of-r2-from-the-regression-output-then-interpret-in-context-the-r2-value-for-this-model." class="section level3" number="6.1.24">
<h3>
<span class="header-section-number">6.1.24</span> (h) Get the value of <span class="math inline">\(R^2\)</span> from the regression output, then interpret (in context) the <span class="math inline">\(R^2\)</span> value for this model.<a class="anchor" aria-label="anchor" href="#h-get-the-value-of-r2-from-the-regression-output-then-interpret-in-context-the-r2-value-for-this-model."><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mice.lm</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = BMGain ~ DayPct, data = mice)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.6990 -1.1694  0.0728  0.9174  5.8975 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.11280    1.38211   0.805    0.428    
DayPct       0.12727    0.02315   5.499 1.03e-05 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.231 on 25 degrees of freedom
Multiple R-squared:  0.5474,    Adjusted R-squared:  0.5293 
F-statistic: 30.24 on 1 and 25 DF,  p-value: 1.032e-05</code></pre>
<p><em>Answer:</em> From <code>Multiple R-squared</code>, we get <span class="math inline">\(R^2 = 0.547\)</span>. The percent of calories that a mouse eats during the day explains about 55% of the variability in weight gain for this study.</p>
<hr>
</div>
<div id="forbes-example" class="section level3" number="6.1.25">
<h3>
<span class="header-section-number">6.1.25</span> Forbes Example<a class="anchor" aria-label="anchor" href="#forbes-example"><i class="fas fa-link"></i></a>
</h3>
<p>In the mid 1800s, James D. Forbes conducted a experiments designed to determine if the atmospheric pressure at a given location can just be determined by the boiling temp of water at that location.</p>
</div>
<div id="a-fit-the-linear-regression-of-pressure-on-temp" class="section level3" number="6.1.26">
<h3>
<span class="header-section-number">6.1.26</span> (a) Fit the linear regression of <code>Pressure</code> on <code>Temp</code>:<a class="anchor" aria-label="anchor" href="#a-fit-the-linear-regression-of-pressure-on-temp"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forbes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"http://math.carleton.edu/kstclair/data/forbes.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pressure</span> <span class="op">~</span> <span class="va">Temp</span>, data<span class="op">=</span><span class="va">forbes</span>, pch<span class="op">=</span><span class="fl">19</span>, main <span class="op">=</span> <span class="st">"Pressure vs. Temp"</span><span class="op">)</span></span>
<span><span class="va">forbes.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Pressure</span> <span class="op">~</span> <span class="va">Temp</span>, data<span class="op">=</span><span class="va">forbes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">forbes.lm</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-29-1.png" width="100%"></div>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">forbes.lm</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = Pressure ~ Temp, data = forbes)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.25717 -0.11246 -0.05102  0.14283  0.64994 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -81.06373    2.05182  -39.51   &lt;2e-16 ***
Temp          0.52289    0.01011   51.74   &lt;2e-16 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2328 on 15 degrees of freedom
Multiple R-squared:  0.9944,    Adjusted R-squared:  0.9941 
F-statistic:  2677 on 1 and 15 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li>Describe the relationship between pressure and temp (strength, form, direction).</li>
</ul>
<p><em>Answer:</em> This is a strong, positive relationship that looks linear.</p>
<ul>
<li>Interpret the value of <span class="math inline">\(R^2\)</span>
</li>
</ul>
<p><em>Answer:</em> About 99.4% of the variation observed in pressure can be explained by the boiling point temps.</p>
</div>
<div id="b-check-the-residuals-plot" class="section level3" number="6.1.27">
<h3>
<span class="header-section-number">6.1.27</span> (b) Check the residuals plot<a class="anchor" aria-label="anchor" href="#b-check-the-residuals-plot"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">forbes.lm</span><span class="op">)</span> <span class="op">~</span> <span class="va">Temp</span>, data<span class="op">=</span><span class="va">forbes</span>, pch<span class="op">=</span><span class="fl">19</span>, main <span class="op">=</span> <span class="st">"Residuals plot"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-30-1.png" width="100%"></div>
<ul>
<li>Is the relationship between pressure and temp linear?</li>
</ul>
<p><em>Answer:</em> No! There is curvature, which means the linear model is systematically underestimating pressure at low and high temps and overestimating pressure at mid-range temps.</p>
<ul>
<li>Does the residual plot highlight an unusual case? Explain.</li>
</ul>
<p><em>Answer:</em> Yes, there is one case that has an unusually high pressure value given its temp.</p>
</div>
<div id="c-fixing-the-model" class="section level3" number="6.1.28">
<h3>
<span class="header-section-number">6.1.28</span> (c) “Fixing” the model<a class="anchor" aria-label="anchor" href="#c-fixing-the-model"><i class="fas fa-link"></i></a>
</h3>
<p>A linear model can be used with this data if we <strong>transform</strong> the response variable to the logarithmic scale. Here <code>log(y)</code> gives the natural log of the variable <code>y</code>.</p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Pressure</span><span class="op">)</span> <span class="op">~</span> <span class="va">Temp</span>, data<span class="op">=</span><span class="va">forbes</span>, pch<span class="op">=</span><span class="fl">19</span>, main <span class="op">=</span> <span class="st">"Pressure vs. Temp"</span><span class="op">)</span></span>
<span><span class="va">forbes.lm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Pressure</span><span class="op">)</span> <span class="op">~</span> <span class="va">Temp</span>, data<span class="op">=</span><span class="va">forbes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">forbes.lm2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-31-1.png" width="100%"></div>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">forbes.lm2</span><span class="op">)</span> <span class="op">~</span> <span class="va">Temp</span>, data<span class="op">=</span><span class="va">forbes</span>, pch<span class="op">=</span><span class="fl">19</span>, main <span class="op">=</span> <span class="st">"Residuals plot"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-31-2.png" width="100%"></div>
<ul>
<li>Has the curvature in the scatterplot and residuals plots been reduced by logging the variables?</li>
</ul>
<p><em>Answer:</em> Yes, there is less curvature</p>
<ul>
<li>Has the outlier been eliminated by logging the variables?</li>
</ul>
<p><em>Answer:</em> No, the outlier is still present.</p>
</div>
<div id="d-removing-bad-measurement" class="section level3" number="6.1.29">
<h3>
<span class="header-section-number">6.1.29</span> (d) Removing bad measurement<a class="anchor" aria-label="anchor" href="#d-removing-bad-measurement"><i class="fas fa-link"></i></a>
</h3>
<p>Identify which case has the large residual value around 0.03.</p>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">forbes.lm2</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">forbes.lm2</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.02</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>        12 
0.03131388 </code></pre>
<p>Repeat part (c) but this time remove the case you identified. The easiest way to do this is to create a new version of the data with row 12 removed:</p>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forbes2</span> <span class="op">&lt;-</span> <span class="va">forbes</span><span class="op">[</span><span class="op">-</span><span class="fl">12</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Pressure</span><span class="op">)</span> <span class="op">~</span> <span class="va">Temp</span>, data<span class="op">=</span><span class="va">forbes2</span>, pch<span class="op">=</span><span class="fl">19</span>, main <span class="op">=</span> <span class="st">"Pressure vs. Temp"</span><span class="op">)</span></span>
<span><span class="va">forbes.lm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Pressure</span><span class="op">)</span> <span class="op">~</span> <span class="va">Temp</span>, data<span class="op">=</span><span class="va">forbes2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">forbes.lm2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-33-1.png" width="100%"></div>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">forbes.lm2</span><span class="op">)</span> <span class="op">~</span> <span class="va">Temp</span>, data<span class="op">=</span><span class="va">forbes2</span>, pch<span class="op">=</span><span class="fl">19</span>, main <span class="op">=</span> <span class="st">"Residuals plot"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Class_Activity_6_files/figure-html/unnamed-chunk-33-2.png" width="100%"></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="class-activity-5.html"><span class="header-section-number">5</span> Class Activity 5</a></div>
<div class="next"><a href="what-is-r.html"><span class="header-section-number">8</span> What is R?</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#class-activity-6"><span class="header-section-number">6</span> Class Activity 6</a></li>
<li>
<a class="nav-link" href="#your-turn-1-4"><span class="header-section-number">6.1</span> Your Turn 1</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#beer-example"><span class="header-section-number">6.1.1</span> Beer Example</a></li>
<li><a class="nav-link" href="#a-always-start-with-a-visual"><span class="header-section-number">6.1.2</span> (a) Always start with a visual!!!!</a></li>
<li><a class="nav-link" href="#b-computing-correlation"><span class="header-section-number">6.1.3</span> (b) Computing correlation</a></li>
<li><a class="nav-link" href="#c-fitting-a-regression-line"><span class="header-section-number">6.1.4</span> (c) Fitting a regression line</a></li>
<li><a class="nav-link" href="#d-interpret-the-slope-in-context."><span class="header-section-number">6.1.5</span> (d) Interpret the slope in context.</a></li>
<li><a class="nav-link" href="#e-interpret-the-intercept-in-context-if-it-makes-sense-to-do-so."><span class="header-section-number">6.1.6</span> (e) Interpret the intercept in context, if it makes sense to do so.</a></li>
<li><a class="nav-link" href="#f-if-your-friend-at-ohio-state-drank-2-beers-what-would-you-predict-their-bac-to-be"><span class="header-section-number">6.1.7</span> (f) If your friend at Ohio State drank 2 beers, what would you predict their BAC to be?</a></li>
<li><a class="nav-link" href="#g-find-the-residual-for-the-student-in-the-dataset-who-drank-2-beers-and-had-a-bac-of-0.03."><span class="header-section-number">6.1.8</span> (g) Find the residual for the student in the dataset who drank 2 beers and had a BAC of 0.03.</a></li>
<li><a class="nav-link" href="#h-getting-residuals-in-r"><span class="header-section-number">6.1.9</span> (h) Getting residuals in R</a></li>
<li><a class="nav-link" href="#i-getting-r2-value"><span class="header-section-number">6.1.10</span> (i) Getting \(R^2\) value</a></li>
<li><a class="nav-link" href="#j-making-a-residuals-plot"><span class="header-section-number">6.1.11</span> (j) Making a residuals plot</a></li>
<li><a class="nav-link" href="#k-identifying-points"><span class="header-section-number">6.1.12</span> (k) Identifying points</a></li>
<li><a class="nav-link" href="#l-checking-outlier-influence"><span class="header-section-number">6.1.13</span> (l) Checking outlier influence</a></li>
<li><a class="nav-link" href="#m-adding-a-categorical-variable-to-your-plot"><span class="header-section-number">6.1.14</span> (m) Adding a categorical variable to your plot</a></li>
<li><a class="nav-link" href="#n-regression-lines-by-groups"><span class="header-section-number">6.1.15</span> (n) Regression lines by groups</a></li>
<li><a class="nav-link" href="#mice-mass-example"><span class="header-section-number">6.1.16</span> Mice Mass Example</a></li>
<li><a class="nav-link" href="#a-what-are-the-coordinates-roughly-of-the-case-with-the-largest-positive-residual"><span class="header-section-number">6.1.17</span> (a) What are the coordinates (roughly) of the case with the largest positive residual?</a></li>
<li><a class="nav-link" href="#b-what-are-the-coordinates-roughly-of-the-case-with-the-most-negative-residual"><span class="header-section-number">6.1.18</span> (b) What are the coordinates (roughly) of the case with the most negative residual?</a></li>
<li><a class="nav-link" href="#c-what-is-the-predicted-body-mass-gain-for-a-mouse-that-eats-50-of-its-calories-during-the-day"><span class="header-section-number">6.1.19</span> (c) What is the predicted body mass gain for a mouse that eats 50% of its calories during the day?</a></li>
<li><a class="nav-link" href="#d-find-the-residual-for-the-mouse-who-ate-48.3-of-its-calories-during-the-day-and-gained-5.82-grams."><span class="header-section-number">6.1.20</span> (d) Find the residual for the mouse who ate 48.3% of its calories during the day and gained 5.82 grams.</a></li>
<li><a class="nav-link" href="#e-interpret-the-slope-of-the-regression-line-in-context."><span class="header-section-number">6.1.21</span> (e) Interpret the slope of the regression line in context.</a></li>
<li><a class="nav-link" href="#f-interpret-the-intercept-of-the-line-in-context-if-it-makes-sense-to-do-so."><span class="header-section-number">6.1.22</span> (f) Interpret the intercept of the line in context, if it makes sense to do so.</a></li>
<li><a class="nav-link" href="#g-use-the-correlation-value-to-compute-r2-then-interpret-in-context-the-r2-value-for-this-model."><span class="header-section-number">6.1.23</span> (g) Use the correlation value to compute \(R^2\), then interpret (in context) the \(R^2\) value for this model.</a></li>
<li><a class="nav-link" href="#h-get-the-value-of-r2-from-the-regression-output-then-interpret-in-context-the-r2-value-for-this-model."><span class="header-section-number">6.1.24</span> (h) Get the value of \(R^2\) from the regression output, then interpret (in context) the \(R^2\) value for this model.</a></li>
<li><a class="nav-link" href="#forbes-example"><span class="header-section-number">6.1.25</span> Forbes Example</a></li>
<li><a class="nav-link" href="#a-fit-the-linear-regression-of-pressure-on-temp"><span class="header-section-number">6.1.26</span> (a) Fit the linear regression of Pressure on Temp:</a></li>
<li><a class="nav-link" href="#b-check-the-residuals-plot"><span class="header-section-number">6.1.27</span> (b) Check the residuals plot</a></li>
<li><a class="nav-link" href="#c-fixing-the-model"><span class="header-section-number">6.1.28</span> (c) “Fixing” the model</a></li>
<li><a class="nav-link" href="#d-removing-bad-measurement"><span class="header-section-number">6.1.29</span> (d) Removing bad measurement</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/Class_Activity_6.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/Class_Activity_6.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Stat 120</strong>" was written by Deepak Bastola. It was last built on 2023-01-01.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>

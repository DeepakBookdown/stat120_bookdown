<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 20 Class Activity 20 | Stat 120</title>
<meta name="author" content="Deepak Bastola">
<meta name="description" content="20.1 Example 1: Food poisoning Suppose in an outbreak, 447 of the 998 individuals who ate beef curry were observed to have food poisoning symptoms. As researchers, suppose we want to test the...">
<meta name="generator" content="bookdown 0.31 with bs4_book()">
<meta property="og:title" content="Chapter 20 Class Activity 20 | Stat 120">
<meta property="og:type" content="book">
<meta property="og:description" content="20.1 Example 1: Food poisoning Suppose in an outbreak, 447 of the 998 individuals who ate beef curry were observed to have food poisoning symptoms. As researchers, suppose we want to test the...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 20 Class Activity 20 | Stat 120">
<meta name="twitter:description" content="20.1 Example 1: Food poisoning Suppose in an outbreak, 447 of the 998 individuals who ate beef curry were observed to have food poisoning symptoms. As researchers, suppose we want to test the...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.1/transition.js"></script><script src="libs/bs3compat-0.4.1/tabs.js"></script><script src="libs/bs3compat-0.4.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Stat 120</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About</a></li>
<li><a class="" href="class-activity-1.html"><span class="header-section-number">1</span> Class Activity 1</a></li>
<li><a class="" href="class-activity-2.html"><span class="header-section-number">2</span> Class Activity 2</a></li>
<li><a class="" href="class-activity-3.html"><span class="header-section-number">3</span> Class Activity 3</a></li>
<li><a class="" href="class-activity-4.html"><span class="header-section-number">4</span> Class Activity 4</a></li>
<li><a class="" href="class-activity-5.html"><span class="header-section-number">5</span> Class Activity 5</a></li>
<li><a class="" href="class-activity-6.html"><span class="header-section-number">6</span> Class Activity 6</a></li>
<li><a class="" href="class-activity-7.html"><span class="header-section-number">7</span> Class Activity 7</a></li>
<li><a class="" href="class-activity-8.html"><span class="header-section-number">8</span> Class Activity 8</a></li>
<li><a class="" href="class-activity-9.html"><span class="header-section-number">9</span> Class Activity 9</a></li>
<li><a class="" href="class-activity-10.html"><span class="header-section-number">10</span> Class Activity 10</a></li>
<li><a class="" href="class-activity-11.html"><span class="header-section-number">11</span> Class Activity 11</a></li>
<li><a class="" href="class-activity-12.html"><span class="header-section-number">12</span> Class Activity 12</a></li>
<li><a class="" href="class-activity-13.html"><span class="header-section-number">13</span> Class Activity 13</a></li>
<li><a class="" href="class-activity-14.html"><span class="header-section-number">14</span> Class Activity 14</a></li>
<li><a class="" href="class-activity-15.html"><span class="header-section-number">15</span> Class Activity 15</a></li>
<li><a class="" href="class-activity-16.html"><span class="header-section-number">16</span> Class Activity 16</a></li>
<li><a class="" href="class-activity-17.html"><span class="header-section-number">17</span> Class Activity 17</a></li>
<li><a class="" href="class-activity-18.html"><span class="header-section-number">18</span> Class Activity 18</a></li>
<li><a class="" href="class-activity-19.html"><span class="header-section-number">19</span> Class Activity 19</a></li>
<li><a class="active" href="class-activity-20.html"><span class="header-section-number">20</span> Class Activity 20</a></li>
<li><a class="" href="class-activity-21.html"><span class="header-section-number">21</span> Class Activity 21</a></li>
<li><a class="" href="class-activity-22.html"><span class="header-section-number">22</span> Class Activity 22</a></li>
<li><a class="" href="class-activity-23.html"><span class="header-section-number">23</span> Class Activity 23</a></li>
<li><a class="" href="class-activity-24.html"><span class="header-section-number">24</span> Class Activity 24</a></li>
<li class="book-part">Basics R</li>
<li><a class="" href="what-is-r.html"><span class="header-section-number">26</span> What is R?</a></li>
<li><a class="" href="r-markdown.html"><span class="header-section-number">27</span> R Markdown</a></li>
<li><a class="" href="helpful-r-codes.html"><span class="header-section-number">28</span> Helpful R codes</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="class-activity-20" class="section level1" number="20">
<h1>
<span class="header-section-number">20</span> Class Activity 20<a class="anchor" aria-label="anchor" href="#class-activity-20"><i class="fas fa-link"></i></a>
</h1>
<div id="example-1-food-poisoning" class="section level2" number="20.1">
<h2>
<span class="header-section-number">20.1</span> Example 1: Food poisoning<a class="anchor" aria-label="anchor" href="#example-1-food-poisoning"><i class="fas fa-link"></i></a>
</h2>
<p>Suppose in an outbreak, 447 of the 998 individuals who ate beef curry were observed to have food poisoning symptoms. As researchers, suppose we want to test the hypothesis that the probability (long run proportion) of a “random individual who ate beef curry” having food poisoning is 0.1. Conduct an appropriate hypothesis test.</p>
<details><summary><red>Click for answer</red></summary><p><em>Answer:</em>The set of hypotheses are:</p>
<p><span class="math inline">\(\mathrm{H}_0\)</span> : <span class="math inline">\(p_{FP} = 0.1, \qquad p_{NFP} = 0.9\)</span>
<span class="math inline">\(\mathrm{H}_{\mathrm{a}} : \text{One proportion is different}\)</span></p>
<p>where <span class="math inline">\(p_{FP}\)</span> is the proportion of people who had food poisoning and <span class="math inline">\(p_{NFP}\)</span> is the proportion who did not have food poisoning. The expected count assuming the null hypothesis is true is <span class="math inline">\(n*p_{FP} = 998*0.1 = 99.8\)</span> and <span class="math inline">\(n*p_{NFP} = 998*0.9 = 898.2\)</span>, respectively. The expected count is larger than 5, so we can proceed with the chi-square test. The observed count is 447 and 551 respectively. So, the test statistics can be constructed as</p>
<p><span class="math display">\[\begin{align*}
\chi^2 = \sum \frac{(O-E)^2}{E} = \frac{(447 - 99.8)^2}{99.8} +   \frac{(551 - 898.2)^2}{898.2}= 1342.105
\end{align*}\]</span></p>
<div class="sourceCode" id="cb468"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fl">447</span> <span class="op">-</span> <span class="fl">99.8</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">99.8</span> <span class="op">+</span> <span class="op">(</span><span class="fl">551</span> <span class="op">-</span> <span class="fl">898.2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">898.2</span></span></code></pre></div>
<pre><code>[1] 1342.105</code></pre>
<p>The degrees of freedom corresponding to this test is 1. So, the p-value can be calculated to be 0 as:</p>
<div class="sourceCode" id="cb470"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">1342.105</span>, df <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0</code></pre>
<p>We can also do the test in R using the <code>chisq.test</code> function.</p>
<div class="sourceCode" id="cb472"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">447</span>, <span class="fl">551</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>
    Chi-squared test for given probabilities

data:  c(447, 551)
X-squared = 1342.1, df = 1, p-value &lt; 2.2e-16</code></pre>
<p>We reject the null hypothesis <span class="math inline">\((\chi^2 = 1342.105, df = 1, p-value \approx 0)\)</span>. There is a significant evidence that the proportion of individuals who eat beef curry and get sick is not <span class="math inline">\(0.1\)</span></p>
</details><p><br></p>
</div>
<div id="example-2-candy-flavors" class="section level2" number="20.2">
<h2>
<span class="header-section-number">20.2</span> Example 2: Candy flavors<a class="anchor" aria-label="anchor" href="#example-2-candy-flavors"><i class="fas fa-link"></i></a>
</h2>
<p>We have bags of candy with five flavors in each bag. We collect a random sample of ten bags. Each bag has 100 pieces of candy and five flavors. Use Chi-square goodness of fit test to test if the proportions of the five flavors in each bag are the same. The data table below shows the combined flavor counts from all 10 bags of candy. Fill in the details below:</p>
<details><summary><red>Click for answer</red></summary><table style="width:100%;" class="table table-sm">
<colgroup>
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th>Flavor</th>
<th>Observed Count (O)</th>
<th>Expected Count (E)</th>
<th><span class="math inline">\(O-E\)</span></th>
<th><span class="math inline">\((O-E)^2\)</span></th>
<th><span class="math inline">\((O-E)^2/E\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Apple</td>
<td>180</td>
<td>200</td>
<td>-20</td>
<td>400</td>
<td>2</td>
</tr>
<tr class="even">
<td>Lime</td>
<td>250</td>
<td>200</td>
<td>50</td>
<td>2500</td>
<td>12.5</td>
</tr>
<tr class="odd">
<td>Cherry</td>
<td>120</td>
<td>200</td>
<td>-80</td>
<td>2500</td>
<td>32</td>
</tr>
<tr class="even">
<td>Orange</td>
<td>225</td>
<td>200</td>
<td>25</td>
<td>625</td>
<td>3.125</td>
</tr>
<tr class="odd">
<td>Grape</td>
<td>225</td>
<td>200</td>
<td>25</td>
<td>625</td>
<td>3.125</td>
</tr>
</tbody>
</table>
<p><em>Answer:</em></p>
<p><span class="math display">\[H_0: p_1 = p_2 = p_3 = p_4 = p_5 = 1/5\]</span>
<span class="math display">\[H_a: \text{at least one $p_i$ not equal to 1/5}\]</span></p>
<div class="sourceCode" id="cb474"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">52.75</span>, df <span class="op">=</span> <span class="fl">5</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 9.612522e-11</code></pre>
<p>The observed test statistics is:</p>
<p><span class="math display">\[\begin{align*}
\chi^2 &amp;= \sum_{i=1}^5 \frac{(O_i-E_i)^2}{E_i} = \frac{(180 - 200)^2}{200} + \frac{(250 - 200)^2}{200}\\ &amp; \qquad + \frac{(120 - 200)^2}{200} + \frac{(225 - 200)^2}{200} + \frac{(225 - 200)^2}{200}\\
&amp;=  52.75
\end{align*}\]</span></p>
<div class="sourceCode" id="cb476"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">180</span>, <span class="fl">250</span>, <span class="fl">120</span>, <span class="fl">225</span>, <span class="fl">225</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>
    Chi-squared test for given probabilities

data:  c(180, 250, 120, 225, 225)
X-squared = 52.75, df = 4, p-value = 9.613e-11</code></pre>
<p>We reject the null hypothesis <span class="math inline">\((\chi^2 = 52.75, df = 4, p-value \approx 0)\)</span>. We have significant evidence to claim that at least one proportion of flavors is not the same as others.</p>
</details><p><br></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="class-activity-19.html"><span class="header-section-number">19</span> Class Activity 19</a></div>
<div class="next"><a href="class-activity-21.html"><span class="header-section-number">21</span> Class Activity 21</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#class-activity-20"><span class="header-section-number">20</span> Class Activity 20</a></li>
<li><a class="nav-link" href="#example-1-food-poisoning"><span class="header-section-number">20.1</span> Example 1: Food poisoning</a></li>
<li><a class="nav-link" href="#example-2-candy-flavors"><span class="header-section-number">20.2</span> Example 2: Candy flavors</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/Class_Activity_20.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/Class_Activity_20.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Stat 120</strong>" was written by Deepak Bastola. It was last built on 2023-03-01.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
